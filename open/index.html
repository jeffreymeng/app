Loading...

<script>
    //http://stackoverflow.com/a/901144/5511561
    function getQuery(name) {
        var url = window.location.href;
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    if (getQuery("mode") == "local") {
        if (getQuery("objectURL") == null && getQuery("objectURL") == "") {
            window.location.href = "/invalidurl/?url=" + encodeURIComponent(window.location.href);
        }
        switch (getQuery("fileType")) {
            case "video/mp4":
            case "video/ogg":
            case "video/webm":
                window.location.href = "/view/video/?mode=local&type=" + encodeURIComponent(getQuery("fileType")) + "&objectURL=" + encodeURIComponent(getQuery("objectURL")) + "&name=" + encodeURIComponent(getQuery("filename"));
                break;
            default:
                //type not supported.
        }
    } else {//else if (mode == "url")
    //no mode = url required
        var path = "";
        if (getQuery("url") == null && getQuery("url") == "") {
            window.location.href = "/invalidurl/?url=" + encodeURIComponent(window.location.href);
        }
        switch (getQuery("fileType")) {
            case "video/mp4":
            case "video/ogg":
            case "video/webm":
                path = "/view/video/";
                break;
            default:
                //type not supported.
                
        }
        window.location.href =  path + window.location.search;/*"?mode=url&type=" + encodeURIComponent(getQuery("fileType")) +
        "&url=" + encodeURIComponent(getQuery("objectURL")) + 
        ((getQuery("filename") != null && getQuery("filename") != "") ? "&name=" + encodeURIComponent(getQuery("filename")) : "");
        */
    }
</script>
